# 用户行为分析智能体平台 - 用户使用指南

## 📖 概述

用户行为分析智能体平台是一个基于CrewAI多智能体框架的自动化数据分析系统，专门用于处理和分析Google Analytics 4 (GA4) 事件数据。通过多个专业化AI智能体的协作，平台能够提供全面的用户行为洞察和业务建议。

## 🚀 快速开始

### 系统要求

- **操作系统**: Windows 10+, macOS 10.14+, Linux (Ubuntu 18.04+)
- **Python版本**: 3.8 或更高版本
- **内存**: 8GB RAM (推荐16GB)
- **存储空间**: 2GB 可用磁盘空间
- **网络**: 稳定的互联网连接 (用于API调用)

### 安装步骤

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd user-behavior-analytics-platform
   ```

2. **自动化安装**
   ```bash
   python setup.py
   ```
   
   这将自动创建虚拟环境、安装依赖并进行基础配置。

3. **配置API密钥**
   
   编辑项目根目录下的 `.env` 文件：
   ```env
   GOOGLE_API_KEY=your_google_gemini_api_key_here
   ```
   
   > 💡 **获取API密钥**: 访问 [Google AI Studio](https://makersuite.google.com/app/apikey) 获取免费的Gemini API密钥

4. **启动应用**
   ```bash
   # 激活虚拟环境
   source venv/bin/activate  # Linux/macOS
   # 或
   venv\Scripts\activate     # Windows
   
   # 启动应用
   streamlit run main.py
   ```

5. **访问应用**
   
   打开浏览器访问: `http://localhost:8501`

## 📊 功能模块详解

### 1. 数据上传模块

#### 支持的数据格式
- **GA4 NDJSON格式**: 从Google Analytics 4导出的标准NDJSON文件
- **文件扩展名**: `.ndjson`, `.json`, `.jsonl`
- **文件大小限制**: 默认100MB (可在设置中调整)

#### 数据上传流程

1. **选择文件**
   - 点击"选择GA4 NDJSON文件"按钮
   - 选择本地的GA4数据文件
   - 系统会显示文件基本信息

2. **文件预览**
   - 点击"🔍 预览文件"查看文件内容
   - 系统显示前5行数据样例
   - 确认数据格式正确

3. **开始处理**
   - 点击"🚀 开始处理"按钮
   - 系统自动执行数据解析、验证和清洗
   - 实时显示处理进度

4. **查看结果**
   - 处理完成后查看数据摘要
   - 检查数据质量报告
   - 确认数据加载成功

#### 数据质量要求

**必需字段**:
- `event_date`: 事件日期
- `event_timestamp`: 事件时间戳
- `event_name`: 事件名称
- `user_pseudo_id`: 用户伪ID

**推荐字段**:
- `user_id`: 用户真实ID
- `platform`: 平台信息
- `device`: 设备信息
- `geo`: 地理位置信息
- `traffic_source`: 流量来源

### 2. 智能分析模块

智能分析模块使用CrewAI多智能体协作，自动执行全面的用户行为分析。

#### 分析流程

1. **启动智能分析**
   - 确保数据已成功上传
   - 选择"🚀 智能分析"模块
   - 点击"开始智能分析"按钮

2. **智能体协作过程**
   - **数据处理智能体**: 数据预处理和质量检查
   - **事件分析智能体**: 事件模式和趋势分析
   - **留存分析智能体**: 用户留存率计算
   - **转化分析智能体**: 转化漏斗构建
   - **用户分群智能体**: 用户群体识别
   - **路径分析智能体**: 用户行为路径分析
   - **报告生成智能体**: 综合报告生成

3. **查看分析结果**
   - 实时查看各智能体的分析进度
   - 查看中间分析结果
   - 获取最终综合报告

### 3. 专项分析模块

#### 3.1 事件分析

**功能特性**:
- 事件频次统计和排名
- 事件趋势分析和预测
- 事件关联性分析
- 关键事件识别

**使用方法**:
1. 选择"📊 事件分析"模块
2. 设置分析参数:
   - 时间粒度 (日/周/月)
   - 分析时间范围
   - 热门事件数量限制
3. 点击"开始分析"
4. 查看可视化结果和洞察

**输出结果**:
- 事件频次分布图
- 事件趋势时间线
- 事件关联热力图
- 关键事件识别报告

#### 3.2 留存分析

**功能特性**:
- 用户队列构建
- 多周期留存率计算
- 留存曲线生成
- 流失原因分析

**使用方法**:
1. 选择"📈 留存分析"模块
2. 配置分析参数:
   - 留存周期 (1天、7天、14天、30天)
   - 队列类型 (日队列/周队列/月队列)
   - 最小队列大小
3. 执行分析
4. 查看留存热力图和趋势

**输出结果**:
- 留存率热力图
- 留存曲线图
- 队列分析表
- 流失预测报告

#### 3.3 转化分析

**功能特性**:
- 自动转化漏斗构建
- 转化率计算
- 瓶颈识别
- 转化路径优化建议

**使用方法**:
1. 选择"🔄 转化分析"模块
2. 定义转化步骤:
   - 自动识别关键转化事件
   - 或手动定义转化路径
3. 设置转化窗口时间
4. 执行漏斗分析
5. 查看转化结果和建议

**输出结果**:
- 转化漏斗可视化
- 各步骤转化率
- 流失点分析
- 优化建议报告

#### 3.4 用户分群

**功能特性**:
- 基于行为的智能分群
- 用户特征提取
- 群体画像生成
- 个性化营销建议

**使用方法**:
1. 选择"👥 用户分群"模块
2. 选择分群特征:
   - 行为特征 (事件频次、活跃度等)
   - 人口统计特征 (设备、地理位置等)
   - 时间特征 (访问时间、会话时长等)
3. 设置聚类参数:
   - 聚类算法 (K-means/DBSCAN)
   - 聚类数量
   - 最小群体大小
4. 执行分群分析
5. 查看群体特征和建议

**输出结果**:
- 用户分群散点图
- 群体特征雷达图
- 群体画像描述
- 营销策略建议

#### 3.5 路径分析

**功能特性**:
- 用户会话重构
- 行为路径挖掘
- 常见路径识别
- 异常路径检测

**使用方法**:
1. 选择"🛤️ 路径分析"模块
2. 配置路径参数:
   - 会话超时时间
   - 最大路径长度
   - 最小路径支持度
3. 执行路径分析
4. 查看用户行为流程图

**输出结果**:
- 用户行为流程图
- 热门路径排行
- 路径转化分析
- 用户体验优化建议

### 4. 综合报告模块

**功能特性**:
- 多维度分析结果汇总
- 智能洞察生成
- 业务建议提供
- 多格式报告导出

**使用方法**:
1. 确保已完成各项分析
2. 选择"📋 综合报告"模块
3. 选择报告内容:
   - 包含的分析模块
   - 详细程度设置
   - 可视化图表选择
4. 生成综合报告
5. 导出或分享报告

**导出格式**:
- **JSON格式**: 结构化数据，便于程序处理
- **PDF格式**: 专业报告格式，便于分享
- **Excel格式**: 数据表格，便于进一步分析

## ⚙️ 系统设置

### 基础配置

1. **API配置**
   - Google Gemini API密钥设置
   - 模型参数调整 (温度、最大Token数)
   - 请求频率限制

2. **数据处理配置**
   - 最大文件大小限制
   - 数据处理块大小
   - 内存使用限制
   - 临时文件清理设置

3. **界面配置**
   - 主题选择 (明亮/暗黑)
   - 语言设置
   - 页面大小设置
   - 调试信息显示

### 分析参数配置

每个分析模块都提供详细的参数配置选项，用户可以根据具体需求调整:

- **事件分析**: 时间粒度、趋势分析天数、关联性阈值
- **留存分析**: 留存周期、队列类型、分析窗口
- **转化分析**: 转化窗口、归因模型、最小用户数
- **用户分群**: 聚类算法、聚类数量、特征类型
- **路径分析**: 路径支持度、最大路径长度、会话超时

## 📈 最佳实践

### 数据准备

1. **数据质量检查**
   - 确保GA4数据导出完整
   - 检查必需字段是否存在
   - 验证时间戳格式正确

2. **数据量建议**
   - 建议单次分析数据量: 10万-100万事件
   - 时间跨度: 30-90天为最佳
   - 用户数量: 1000+活跃用户

### 分析策略

1. **渐进式分析**
   - 先进行智能分析获得全局视图
   - 再针对关键问题进行专项分析
   - 最后生成综合报告

2. **参数调优**
   - 根据业务特点调整分析参数
   - 多次尝试不同参数组合
   - 关注分析结果的业务意义

3. **结果验证**
   - 对比历史数据验证结果合理性
   - 结合业务知识解读分析结果
   - 关注异常数据和边界情况

### 性能优化

1. **内存管理**
   - 处理大文件时适当调整块大小
   - 及时清理不需要的数据
   - 监控系统内存使用情况

2. **并发控制**
   - 避免同时运行多个重型分析
   - 合理设置API调用频率
   - 使用缓存减少重复计算

## 🔧 故障排除

### 常见问题及解决方案

详细的故障排除指南请参考 [故障排除指南](TROUBLESHOOTING.md)。

### 技术支持

如需技术支持，请:
1. 查看详细的错误日志 (`logs/app.log`)
2. 检查系统配置是否正确
3. 参考API文档和开发者指南
4. 提交GitHub Issue或联系技术支持

---

*本指南持续更新中，如有疑问或建议，欢迎反馈。*